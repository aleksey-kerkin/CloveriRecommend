**README.md**

---

# API Рекомендаций Пользователей

Этот проект представляет собой RESTful API, построенный на базе FastAPI, который позволяет хранить и получать рекомендации пользователей с использованием базы данных SQLite. В проекте используются SQLAlchemy для работы с ORM, Alembic для миграций базы данных и Pydantic для валидации данных.

---

## Содержание

1. [Установка](#установка)
2. [Настройка базы данных](#настройка-базы-данных)
3. [Загрузка начальных данных](#загрузка-начальных-данных)
4. [Запуск приложения](#запуск-приложения)
5. [API Эндпоинты](#api-эндпоинты)
6. [Тестирование API](#тестирование-api)
7. [Структура проекта](#структура-проекта)

---

## Установка

### Требования

- Python 3.12 или выше
- Виртуальная среда (рекомендуется)

### Шаги

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/aleksey-kerkin/cloveri-recommend.git
   cd cloveri-recommend
   ```

2. **Создайте виртуальную среду:**

   ```bash
   python3.12 -m venv venv
   source venv/bin/activate  # Для Windows: venv\Scripts\activate
   ```

3. **Установите зависимости:**

   ```bash
   pip install -r requirements.txt
   ```

---

## Настройка базы данных

### 1. Создайте базу данных

Примените начальную миграцию:

```bash
alembic upgrade head
```

---

## Загрузка начальных данных

Чтобы загрузить начальные данные JSON в базу данных, выполните следующий скрипт:

```bash
python load_data.py
```

Этот скрипт считывает файл `data.json`, который необходимо поместить в корень проекта, и вставляет данные в базу данных SQLite.

---

## Запуск приложения

Запустите приложение FastAPI с помощью Uvicorn:

```bash
uvicorn app.main:app --reload
```

API будет доступен по адресу `http://127.0.0.1:8000`.

---

## API Эндпоинты

### 1. Получение рекомендаций пользователя

- **Эндпоинт:** `/users/{user_hash}`
- **Метод:** `GET`
- **Описание:** Возвращает рекомендации для пользователя на основе его уникального `user_hash`.
- **Параметры:**
  - `user_hash` (параметр пути): Уникальный хеш-идентификатор пользователя.
- **Ответ:**
  - **200 OK:** Возвращает JSON-объект с данными пользователя и рекомендациями.
  - **404 Not Found:** Если пользователь не найден.

**Пример запроса:**

```bash
curl http://127.0.0.1:8000/users/d2ddb9659980d3aff3f7c745d012b27cd6e6fba99fe07d74b80b923d0016103b
```

**Пример ответа:**

```json
{
  "user_hash": "d2ddb9659980d3aff3f7c745d012b27cd6e6fba99fe07d74b80b923d0016103b",
  "name": "неля",
  "recommendations": ["Псити агинара", "Крифарото Мэ Хтенья", "Перец красный печеный г.Салоники"]
}
```

---

## Тестирование API

### 1. Использование Swagger UI

- Откройте браузер и перейдите по адресу `http://127.0.0.1:8000/docs`.
- Используйте интерактивный интерфейс Swagger UI для тестирования API.

### 2. Использование cURL

- Используйте команду `curl` для тестирования API из терминала (как показано в примере выше).

---

## Структура проекта

```
cloveri-recommend
├── app/
│   ├── __init__.py
│   ├── main.py
│   ├── models/
│   │   └── user.py
│   ├── schemas/
│   │   └── user.py
│   ├── routers/
│   │   └── user.py
│   └── db/
│       └── database.py
│       └── alembic/
│           └── ... (файлы миграций Alembic)
├── alembic.ini
├── requirements.txt
├── load_data.py
└── data.json
```

---
